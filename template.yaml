AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: Cloud infrastructure for the back-end of the Trustee platform

Globals:
  Function:
    Timeout: 2
    Runtime: nodejs14.x
    Architectures:
      - x86_64

Parameters:
  Stage:
    Type: String
    Default: dev

Resources:
  # RestApiGateway:
  #   Type: AWS::Serverless::Api
  #   Properties:
  #     Name: trustee
  #     StageName: !Ref Stage
  #     Cors:
  #       AllowHeaders: "'Content-Type,Authorization'"
  #       AllowMethods: "'GET,POST,OPTIONS'"
  #       AllowOrigin: "'*'"
  # Authentication and Authorization
  UserPool:
    Type: AWS::Cognito::UserPool
    Properties:
      UserPoolName: trustee
      Policies:
        PasswordPolicy:
          MinimumLength: 8
          TemporaryPasswordValidityDays: 0
      UsernameAttributes:
        - email
      Schema:
        - AttributeDataType: String
          Name: email
          Required: false
        - AttributeDataType: String
          Name: username
          Required: false
          Mutable: true
  UserPoolClient:
    Type: AWS::Cognito::UserPoolClient
    Properties:
      UserPoolId: !Ref UserPool
      ClientName: trustee-client
      GenerateSecret: false

# Outputs:
#   HelloWorldApi:
#     Description: !Sub "API Gateway endpoint URL for ${Stage} stage"
#     Value: !Sub "https://${RestApiGateway}.execute-api.${AWS::Region}.amazonaws.com/${Stage}"
